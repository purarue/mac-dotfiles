#!/usr/bin/env python3

"""Usage:
    openlinks LINKS... [--help]
    openlinks

Can also pipe to openlinks like:

    echo "https://..." | openlinks
    cat file_with_links.txt | openlinks

Waits for input on stdin, give one or more links as input
Opens link in default browser
input 'q', 'quit', or EOF (Ctrl+D) to quit
"""

import sys
import re
import webbrowser

import docopt
docopt.docopt(__doc__)

# open anything given as a command line argument
links = re.findall(r'(https?://\S+)', " ".join(sys.argv).strip())
for link in links:
    webbrowser.open_new_tab(link)

# open anything piped/as input
while True:
    try:
        user_input = input()
        for line in user_input.split("\s*\n\s*"):
            if line.strip().lower() in ['q', 'quit']:
                sys.exit(1)
            webbrowser.open_new_tab(line)
    except (EOFError, KeyboardInterrupt):
        sys.exit(1)
